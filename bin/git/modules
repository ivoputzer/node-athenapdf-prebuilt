#!/bin/env node

const {execSync} = require('child_process')
const {resolve} = require('path')
const {EOL} = require('os')

module.exports = execSync(`git config -f ${resolve('.gitmodules')} --get-regex submodule\.\*url`)
  .toString()
  .split(EOL)
  .reduce((acc, line) => {
    if (!line) return acc
    const [_, path, url] = line.match(/submodule.([\w\.\/]+).url ([^\s]+)+/im)
    return [...acc, {path, url}]
  }, [])

if (!module.parent){
  module.exports.forEach(({path, url}) => {
    process.stdout.write(`${url} ${resolve(path)}`)
  })
}
